<!-- <section>
  <div class="container">
    <div class="form-box">
      <div class="">
        <h4 *ngIf="showLocations()">Location</h4>
        <mat-form-field
          *ngIf="overviewFormGroup.value.keyCombination.locations.country"
        >
          <mat-label>Country</mat-label>
          <mat-select
            [(ngModel)]="selectedCountries"
            (selectionChange)="onCountryChange($event)"
            multiple
          >
            <mat-option *ngFor="let country of countries" [value]="country.id"
              >{{ country.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field
          *ngIf="overviewFormGroup.value.keyCombination.locations.regions"
        >
          <mat-label>Region</mat-label>
          <mat-select
            [(ngModel)]="selectedRegions"
            (selectionChange)="onRegionChange($event)"
            multiple
          >
            <mat-option *ngFor="let region of regions" [value]="region.id"
              >{{ region.region_name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field
          *ngIf="overviewFormGroup.value.keyCombination.locations.area"
        >
          <mat-label>Area</mat-label>
          <mat-select
            [(ngModel)]="selectedAreas"
            (selectionChange)="onAreaChange($event)"
            multiple
          >
            <mat-option *ngFor="let area of flatAreaData" [value]="area.id">
              <span *ngFor="let i of counter(area.node_level)"
                >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
              </span>
              • {{ area.area_name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field
          *ngIf="overviewFormGroup.value.keyCombination.locations.route"
        >
          <mat-label>Route</mat-label>
          <mat-select
            [(ngModel)]="selectedRoutes"
            (selectionChange)="onRouteChange($event)"
            multiple
          >
            <mat-option *ngFor="let route of routes" [value]="route.route_name"
              >{{ route.route_name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="">
        <h4 *ngIf="showCustomers()">Customer</h4>
        <mat-form-field
          *ngIf="
            overviewFormGroup.value.keyCombination.customers.salesOrganisation
          "
        >
          <mat-label>Sales Organisation</mat-label>
          <mat-select
            [(ngModel)]="selectedSalesOrganisations"
            (selectionChange)="onSalesOrganisationChange()"
            multiple
          >
            <mat-option
              *ngFor="let salesOrganisation of flatSalesOrganisationData"
              [value]="salesOrganisation.id"
            >
              <span *ngFor="let i of counter(salesOrganisation.node_level)"
                >&nbsp;&nbsp;&nbsp;&nbsp;
              </span>
              • {{ salesOrganisation.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field
          *ngIf="overviewFormGroup.value.keyCombination.customers.channel"
        >
          <mat-label>Channel</mat-label>
          <mat-select
            [(ngModel)]="selectedChannels"
            (selectionChange)="onChannelChange()"
            multiple
          >
            <mat-option
              *ngFor="let channel of flatChannelData"
              [value]="channel.id"
            >
              <span *ngFor="let i of counter(channel.node_level)"
                >&nbsp;&nbsp;&nbsp;&nbsp;
              </span>
              • {{ channel.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field
          *ngIf="
            overviewFormGroup.value.keyCombination.customers.customerCategory
          "
        >
          <mat-label>Customer Category</mat-label>
          <mat-select
            [(ngModel)]="selectedCustomerCategories"
            (selectionChange)="onCustomerCategoryChange()"
            multiple
          >
            <mat-option
              *ngFor="let customerCategory of customerCategories"
              [value]="customerCategory.id"
            >
              {{ customerCategory.customer_category_name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field
          *ngIf="overviewFormGroup.value.keyCombination.customers.customer"
        >
          <mat-label>Customer</mat-label>
          <mat-select
            [(ngModel)]="selectedCustomers"
            (selectionChange)="onCustomerChange()"
            multiple
          >
            <mat-option
              *ngFor="let customer of customers"
              [value]="customer.id"
            >
              {{ customer.user.firstname }} {{ customer.user.lastname }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="">
        <h4 *ngIf="showItems()">Item</h4>
        <mat-form-field
          *ngIf="overviewFormGroup.value.keyCombination.items.majorCategory"
        >
          <mat-label>Category</mat-label>
          <mat-select
            [(ngModel)]="selectedCategories"
            (selectionChange)="onCategoryChange()"
            multiple
          >
            <mat-option
              *ngFor="let majorCategory of flatCategoryData"
              [value]="majorCategory.id"
            >
              <span *ngFor="let i of counter(majorCategory.node_level)"
                >&nbsp;&nbsp;&nbsp;&nbsp;
              </span>
              • {{ majorCategory.name }}</mat-option
            >
          </mat-select>
        </mat-form-field>
        <mat-form-field
          *ngIf="overviewFormGroup.value.keyCombination.items.itemGroup"
        >
          <mat-label>Item Group</mat-label>
          <mat-select
            [(ngModel)]="selectedItemGroups"
            (selectionChange)="onItemGroupChange()"
            multiple
          >
            <mat-option
              *ngFor="let itemGroup of itemGroups"
              [value]="itemGroup.id"
              >{{ itemGroup.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field
          *ngIf="overviewFormGroup.value.keyCombination.items.item"
        >
          <mat-label>Item</mat-label>
          <mat-select
            [(ngModel)]="selectedItems"
            (selectionChange)="onItemChange()"
            multiple
          >
            <mat-option *ngFor="let item of items" [value]="item.id"
              >{{ item.item_name }}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>
  </div>
</section> -->
<section>
  <div class="bg-white">
    <div class="form-box">
      <div class="">
        <h4 *ngIf="showLocations()">Location</h4>
        <div class="form-field-box" *ngIf="overviewFormGroup.value.keyCombination.locations.country">
          <app-multiautocomplete isSingle="false" [options]="countries" (selectionchanged)="onCountryChange($event)"
            [control]="selectedCountries" text="name" id="id" placeholder="Select Country">
          </app-multiautocomplete>
          <mat-error *ngIf="(!selectedCountries.value.length ) && showFormError">
            <small>Please select atleast a country.</small>
          </mat-error>
        </div>
        <div class="form-field-box" *ngIf="overviewFormGroup.value.keyCombination.locations.regions">
          <app-multiautocomplete isSingle="false" [options]="regions" (selectionchanged)="onRegionChange($event)"
            [control]="selectedRegions" text="region_name" id="id" placeholder="Select Region">
          </app-multiautocomplete>
          <mat-error *ngIf="(!selectedRegions.value.length ) && showFormError">
            <small>Please select atleast a region.</small>
          </mat-error>
        </div>
        <div class="form-field-box" *ngIf="overviewFormGroup.value.keyCombination.locations.area">
          <app-multiautocomplete isSingle="false" [options]="flatAreaData" (selectionchanged)="onAreaChange($event)"
            [control]="selectedAreas" text="area_name" id="id" placeholder="Select Area">
          </app-multiautocomplete>
          <mat-error *ngIf="(!selectedAreas.value.length ) && showFormError">
            <small>Please select atleast an area.</small>
          </mat-error>
        </div>
        <div class="form-field-box" *ngIf="overviewFormGroup.value.keyCombination.locations.route">
          <app-multiautocomplete isSingle="false" [options]="routes" (selectionchanged)="onRouteChange($event)"
            [control]="selectedRoutes" text="route_name" id="id" placeholder="Select Route">
          </app-multiautocomplete>
          <mat-error *ngIf="(!selectedRoutes.value.length) && showFormError">
            <small>Please select atleast a route.</small>
          </mat-error>
        </div>

      </div>

      <div class="">
        <h4 *ngIf="showCustomers()">Customer</h4>
        <div class="form-field-box" *ngIf="overviewFormGroup.value.keyCombination.customers.salesOrganisation">
          <app-multiautocomplete isSingle="false" [options]="flatSalesOrganisationData"
            (selectionchanged)="onSalesOrganisationChange()" [control]="selectedSalesOrganisations" text="name" id="id"
            placeholder="Select Customer">
          </app-multiautocomplete>
          <mat-error *ngIf="(!selectedSalesOrganisations.value.length) && showFormError">
            <small>Please select atleast a sales organisation.</small>
          </mat-error>
        </div>

        <div class="form-field-box" *ngIf="overviewFormGroup.value.keyCombination.customers.channel">
          <app-multiautocomplete isSingle="false" [options]="flatChannelData" (selectionchanged)="onChannelChange()"
            [control]="selectedChannels" text="name" id="id" placeholder="Select Channel">
          </app-multiautocomplete>
          <mat-error *ngIf="(!selectedChannels.value.length ) && showFormError">
            <small>Please select atleast a channel.</small>
          </mat-error>
        </div>

        <div class="form-field-box" *ngIf="overviewFormGroup.value.keyCombination.customers.customerCategory">
          <app-multiautocomplete isSingle="false" [options]="customerCategories"
            (selectionchanged)="onCustomerCategoryChange()" [control]="selectedCustomerCategories" text="name" id="id"
            placeholder="Select Category">
          </app-multiautocomplete>
          <mat-error *ngIf="(!selectedCustomerCategories.value.length) && showFormError">
            <small>Please select atleast a customer category.</small>
          </mat-error>
        </div>

        <div class="form-field-box" *ngIf="overviewFormGroup.value.keyCombination.customers.customer">
          <div *ngIf="customers.length == 0">
            <div class="select-placeholder-container">
              <mat-spinner class="spinner" diameter="20"></mat-spinner>
            </div>
          </div>

          <ng-container *ngIf="customers.length >0">
            <app-multiautocomplete isSingle="false" [options]="customers" (selectionchanged)="onCustomerChange()"
              [control]="selectedCustomers" [objectName]="'customer-root1'" [param1]="'firstname'" [param2]="'lastname'"
              text="name" id="id" placeholder="Select Customer">
            </app-multiautocomplete>
            <!-- <app-lazy-loading isSingle="false" [options]="customers" (selectionchanged)="onCustomerChange()"
            [control]="selectedCustomers" [objectName]="'customer-root'" text="name" id="id"
            placeholder="Select Customer">
          </app-lazy-loading> -->
            <mat-error *ngIf="(!selectedCustomers.value.length ) && showFormError">
              <small>Please select atleast a customer.</small>
            </mat-error>
          </ng-container>
        </div>

      </div>
      <div>
        <h4 *ngIf="showItems()">Item</h4>
        <div class="form-field-box" *ngIf="overviewFormGroup.value.keyCombination.items.majorCategory">
          <app-multiautocomplete isSingle="false" [options]="flatCategoryData" (selectionchanged)="onCategoryChange()"
            [control]="selectedCategories" [objectName]="'code-root'" [param1]="'item_name'" [param2]="'item_code'"
            placeholder="Select majorCategory">
          </app-multiautocomplete>
          <mat-error *ngIf="(!selectedCategories.value.length) && showFormError">
            <small>Please select atleast a category.</small>
          </mat-error>
        </div>
        <div class="form-field-box" *ngIf="overviewFormGroup.value.keyCombination.items.itemGroup">
          <app-multiautocomplete isSingle="false" [options]="itemGroups" (selectionchanged)="onItemGroupChange()"
            [control]="selectedItemGroups" [objectName]="'code-root'" [param1]="'name'" [param2]="'code'" text="name"
            id="id" placeholder="Select itemGroup">
          </app-multiautocomplete>
          <mat-error *ngIf="(!selectedItemGroups.value.length ) && showFormError">
            <small>Please select atleast an item group.</small>
          </mat-error>
        </div>
        <div *ngIf="overviewFormGroup.value.keyCombination.items.item">
          <div class="form-field-box">
            <!-- <app-multiautocomplete isSingle="true" [options]="items" (selectionchanged)="onItemChange()"
              [control]="selectedItems" [objectName]="'code-root'" [param1]="'item_name'" [param2]="'item_code'"
              text="name" id="id" placeholder="Select item">
            </app-multiautocomplete> -->
            <app-lazy-loading isSingle="true" [options]="items" (selectionchanged)="onItemChange()"
              [control]="selectedItems" [objectName]="'code-root'" id="id" [param1]="'item_name'" [param2]="'item_code'"
              text="item_code" placeholder="Select itemGroup">
            </app-lazy-loading>
            <mat-error *ngIf="(!selectedItems.value.length ) && showFormError">
              <small>Please select atleast an item.</small>
            </mat-error>
          </div>
          <div class="form-field-box">
            <mat-form-field>
              <mat-label>Item Uom</mat-label>
              <mat-select [formControl]="ItemUomCodeFormControl">
                <mat-option *ngFor="let uom of uomFilter " [value]="uom.id">
                  {{ uom.name }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <mat-error *ngIf="(!itemsFormControl.value.length ) && showFormError">
              <small>Please select atleast an item Uom.</small>
            </mat-error>
          </div>
          <div class="form-btn-box item-add-btn">
            <button type="button" (click)="addItemCode()">
              <i class="os-icon os-icon-plus"></i>Add</button>
          </div>
          <div class="items-table-box">
            <div class="table-responsive" style="margin-bottom: 24px;
        ">
              <table mat-table [dataSource]="itemSource" *ngIf="itemSource.data.length"
                class="mat-elevation-z8 table table-hover">
                <ng-container matColumnDef="itemName">
                  <th mat-header-cell *matHeaderCellDef> Item Name </th>
                  <td mat-cell *matCellDef="let element"> {{ element.item_name }} </td>
                </ng-container>
                <ng-container matColumnDef="itemUom">
                  <th mat-header-cell *matHeaderCellDef> Item Uom </th>
                  <td mat-cell *matCellDef="let element"> {{ element.item_uom_name }} </td>
                </ng-container>
                <ng-container matColumnDef="actions">
                  <th mat-header-cell *matHeaderCellDef> Actions </th>
                  <td mat-cell *matCellDef="let element; index as index">
                    <button (click)="editItemCode(index, element)"><i class="fa fa-edit"></i></button>
                    <button (click)="deleteItemCode(index)" class="trash-btn"><i class="fa fa-trash"></i></button>
                  </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
              </table>
            </div>
            <mat-paginator [hidden]="hidePaginator(itemSource.data.length)" pageSize="5" [pageSizeOptions]="[5,10]">
            </mat-paginator>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- <pre>{{overviewFormGroup.value | json}}</pre> -->
</section>